/* Lenis Smooth Scroll - Mobile Optimized */

/* ============================= */
/* Base Configuration */
/* ============================= */

/* Reset native smooth scroll - Lenis handles it */
html {
    scroll-behavior: auto !important;
    /* Prevent overscroll bounce on iOS/macOS */
    overscroll-behavior-y: none;
}

/* Lenis container styles */
html.lenis,
html.lenis body {
    height: auto;
    /* Critical for mobile performance */
    -webkit-overflow-scrolling: touch !important;
}

.lenis.lenis-smooth {
    scroll-behavior: auto !important;
}

.lenis.lenis-smooth [data-lenis-prevent] {
    overscroll-behavior: contain;
}

.lenis.lenis-stopped {
    overflow: hidden;
}

/* ============================= */
/* Mobile Specific Optimizations */
/* ============================= */

/* Mobile optimizations - only safe properties */
@media (max-width: 1023px) {
    html,
    body {
        /* Basic mobile optimizations without breaking fixed positioning */
        -webkit-overflow-scrolling: touch !important;
        overflow-x: hidden;
        overscroll-behavior: none;
        touch-action: pan-y;
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        text-size-adjust: 100%;
    }

    body {
        min-height: 100vh;
        min-height: -webkit-fill-available;
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
    }

    * {
        -webkit-tap-highlight-color: transparent;
        -webkit-overflow-scrolling: touch;
    }

    /* Removed will-change and transform properties that break fixed positioning */

    .ios-safari-fix {
        min-height: -webkit-fill-available;
        min-height: 100vh;
    }

    .no-bounce {
        position: fixed;
        width: 100%;
        overflow: hidden;
    }
}

/* ============================= */
/* Desktop Optimizations */
/* ============================= */

@media (min-width: 1024px) {
    html,
    body {
        overflow-x: hidden;
    }

    /* Smoother desktop scrolling */
    * {
        scroll-behavior: auto;
    }
}

/* ============================= */
/* Modal & Overlay Handling */
/* ============================= */

/* Generic modal open state */
body.modal-open:not(.modal-page-scroll),
body.ReactModal__Body--open:not(.modal-page-scroll),
body.hamburger-open,
html.modal-open:not(.modal-page-scroll) {
    overflow: hidden !important;
    position: relative !important;
}

/* Special handling for modals that need scroll */
body.modal-page-scroll {
    overflow: auto !important;
    position: relative !important;
}

/* Order modal special case */
body.order-modal-open,
html.order-modal-open {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
    top: 0 !important;
    left: 0 !important;
}

/* ============================= */
/* Scroll Prevention */
/* ============================= */

/* Elements that should not use smooth scroll */
[data-lenis-prevent] {
    overscroll-behavior: contain;
    overflow: auto;
    -webkit-overflow-scrolling: auto;
}

[data-lenis-prevent-touch] {
    touch-action: none;
}

/* ============================= */
/* Fixed & Pinned Elements */
/* ============================= */

/* Fixed position elements */
.fixed-element,
[data-lenis-fixed] {
    position: fixed !important;
    /* -webkit-backface-visibility: hidden; */
    /* backface-visibility: hidden; */
    /* -webkit-transform: translateZ(0); */
    /* transform: translateZ(0); */
    will-change: auto;
}

/* GSAP ScrollTrigger pinned elements */
[data-pin-spacer] {
    will-change: auto !important;
}

.pin-spacer {
    will-change: auto !important;
}

/* Mobile specific handling for pinned elements */
@media (max-width: 1023px) {
    [data-pin-spacer],
    .pin-spacer {
        /* Disable will-change on mobile for performance */
        will-change: auto !important;

        /* Reset transforms */
        -webkit-transform: none !important;
        transform: none !important;
    }

    /* Fix for pinned sections on touch devices */
    .pin-spacer {
        touch-action: pan-y !important;
    }
}

/* ============================= */
/* Scrollbar Styling */
/* ============================= */

/* Hide scrollbars globally */
html,
body {
    scrollbar-width: none;
    -ms-overflow-style: none;
}

html::-webkit-scrollbar,
body::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
}

/* Show scrollbars for specific modal content */
.modal-content.show-scrollbar,
.scrollable-content.show-scrollbar {
    scrollbar-width: thin !important;
    -ms-overflow-style: auto !important;
}

.modal-content.show-scrollbar::-webkit-scrollbar,
.scrollable-content.show-scrollbar::-webkit-scrollbar {
    display: block !important;
    width: 6px !important;
}

.modal-content.show-scrollbar::-webkit-scrollbar-track,
.scrollable-content.show-scrollbar::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05) !important;
    border-radius: 3px !important;
}

.modal-content.show-scrollbar::-webkit-scrollbar-thumb,
.scrollable-content.show-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2) !important;
    border-radius: 3px !important;
    transition: background 0.2s ease !important;
}

.modal-content.show-scrollbar::-webkit-scrollbar-thumb:hover,
.scrollable-content.show-scrollbar::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.4) !important;
}

/* ============================= */
/* Accessibility & Motion */
/* ============================= */

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
    html,
    body,
    .lenis {
        scroll-behavior: auto !important;
    }

    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ============================= */
/* Performance Classes */
/* ============================= */

/* Use these classes to optimize specific sections */
.perf-optimize {
    contain: layout style paint;
    will-change: auto;
}

.perf-optimize-scroll {
    contain: layout style;
    will-change: transform;
}

/* Disable smooth scroll for specific containers */
.native-scroll {
    overflow: auto !important;
    -webkit-overflow-scrolling: auto !important;
    overscroll-behavior: auto !important;
}

/* ============================= */
/* iOS Specific Fixes */
/* ============================= */

@supports (-webkit-touch-callout: none) {
    /* iOS only styles */
    body {
        /* Fix for iOS viewport height */
        min-height: -webkit-fill-available;
    }

    /* Fix for iOS input zoom */
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="number"],
    input[type="tel"],
    textarea,
    select {
        font-size: 16px !important;
    }

    /* Better scrolling on iOS */
    .ios-scroll-fix {
        -webkit-overflow-scrolling: touch !important;
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
}

/* ============================= */
/* Android Specific Fixes */
/* ============================= */

@media screen and (-webkit-min-device-pixel-ratio: 0) and (hover: none) {
    /* Android only styles */
    html,
    body {
        /* Better touch scrolling on Android */
        scroll-behavior: auto !important;
        overscroll-behavior-y: none;
    }
}

/* ============================= */
/* Debug Mode (remove in production) */
/* ============================= */

.lenis-debug {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 10px;
    font-size: 12px;
    z-index: 99999;
    border-radius: 4px;
    pointer-events: none;
}

.lenis-debug::after {
    content: attr(data-scroll) " | " attr(data-velocity) " | "
        attr(data-direction);
}
